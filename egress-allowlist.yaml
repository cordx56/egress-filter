version: 1
default_policy: deny

doh:
  enabled: false

domains:
  # GitHub
  - pattern: "api.github.com"
    ports: [443]
  - pattern: "github.com"
    ports: [443, 22]
  - pattern: "*.github.com"
    ports: [443]
  - pattern: "raw.githubusercontent.com"
    ports: [443]
  - pattern: "objects.githubusercontent.com"
    ports: [443]

  # Package registries
  - pattern: "registry.npmjs.org"
    ports: [443]
  - pattern: "crates.io"
    ports: [443]
  - pattern: "*.crates.io"
    ports: [443]
  - pattern: "pypi.org"
    ports: [443]
  - pattern: "files.pythonhosted.org"
    ports: [443]

  # DoH servers
  - pattern: "cloudflare-dns.com"
    ports: [443]
  - pattern: "*.cloudflare-dns.com"
    ports: [443]

ip_ranges:
  # Localhost
  - cidr: "127.0.0.0/8"
  - cidr: "::1/128"
  - cidr: "::ffff:127.0.0.0/104"

  # Cloudflare DNS
  - cidr: "1.1.1.1/32"
    ports: [53, 443]
  - cidr: "1.0.0.1/32"
    ports: [53, 443]
  - cidr: "104.16.0.0/12"
    ports: [443]
  - cidr: "2606:4700::/32"
    ports: [53, 443]
